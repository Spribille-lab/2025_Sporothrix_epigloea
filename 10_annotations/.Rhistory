#install.packages("taxize")
library(taxize)
library("ggkegg")
sessionInfo()
input_file <- "Sporothrix_thermara_S_CBS139747MAG_GCA_XXXXXXXXX"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
library(seqRFLP)
library(tidyverse)
library(stringr)
setwd("~/Documents/2023_02_Sporothrix/10_annotations/")
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
View(annotations)
colnames(annotations) = c("Gene_ID",
"Transcript_ID",
"Feature",
"Contig",
"Start",
"Stop",
"Strand",
"Name",
"Product",
"Alias_Synonyms",
"EC_number",
"BUSCO",
"PFAM",
"InterPro",
"EggNog",
"COG",
"GO_Terms",
"Secreted",
"Membrane",
"Protease",
"CAZyme",
"antiSMASH",
"Notes",
"gDNA",
"mRNA",
"CDS_transcript",
"Translation")
# read in the output from DeepLoc 2.0
deeploc <- read.csv(paste("DeepLoc2/",input_file,".deeploc2.csv", sep="")) %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::relocate(Gene_ID) %>%
dplyr::select(Gene_ID, Localizations, Signals)
colnames(deeploc) = c("Gene_ID", "Localizations_DeepLoc2", "Signals_DeepLoc2")
View(deeploc)
annotations2 <- dplyr::left_join(annotations, deeploc) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Product,
Alias_Synonyms,
EC_number,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
orthogroups <- read.delim(paste("../09_orthology/OrthoFinder/Results_Aug07/Custom_results/",input_file_short,".orthogroups.txt", sep=""), header = T, na.strings='') %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::select(Gene_ID, Orthogroup)
annotations3 <- dplyr::left_join(annotations2, orthogroups) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Orthogroup,
Product,
Alias_Synonyms,
EC_number,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
# read in KEGG IDs from KoFamScan
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
input_file <- "Sporothrix_thermara_S_CBS139747_GCA_XXXXXXXXX"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
setwd("~/Documents/2023_02_Sporothrix/10_annotations/")
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
input_file <- "Sporothrix_thermara_S_CBS139747MAG_GCA_XXXXXXXXX"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
library(seqRFLP)
library(tidyverse)
library(stringr)
setwd("~/Documents/2023_02_Sporothrix/10_annotations/")
setwd("~/Documents/2023_02_Sporothrix/10_annotations/")
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
colnames(annotations) = c("Gene_ID",
"Transcript_ID",
"Feature",
"Contig",
"Start",
"Stop",
"Strand",
"Name",
"Product",
"Alias_Synonyms",
"EC_number",
"BUSCO",
"PFAM",
"InterPro",
"EggNog",
"COG",
"GO_Terms",
"Secreted",
"Membrane",
"Protease",
"CAZyme",
"antiSMASH",
"Notes",
"gDNA",
"mRNA",
"CDS_transcript",
"Translation")
# read in the output from DeepLoc 2.0
deeploc <- read.csv(paste("DeepLoc2/",input_file,".deeploc2.csv", sep="")) %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::relocate(Gene_ID) %>%
dplyr::select(Gene_ID, Localizations, Signals)
colnames(deeploc) = c("Gene_ID", "Localizations_DeepLoc2", "Signals_DeepLoc2")
annotations2 <- dplyr::left_join(annotations, deeploc) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Product,
Alias_Synonyms,
EC_number,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
orthogroups <- read.delim(paste("../09_orthology/OrthoFinder/Results_Aug07/Custom_results/",input_file_short,".orthogroups.txt", sep=""), header = T, na.strings='') %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::select(Gene_ID, Orthogroup)
annotations3 <- dplyr::left_join(annotations2, orthogroups) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Orthogroup,
Product,
Alias_Synonyms,
EC_number,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
# read in KEGG IDs from KoFamScan
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
# read in KEGG IDs from KoFamScan
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
View(kegg_mapper)
colnames(kegg_mapper) <- c("TranscriptID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
group_by(TranscriptID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
str(kegg_mapper)
library(data.table)
kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", header=FALSE)
View(kodesc)
kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", sep = "\t", header=FALSE)
View(kodesc)
colnames(kodesc) <- c("KEGG_ID", "KEGG_descr")
View(kegg_mapper)
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("TranscriptID", "KEGG_ID")
View(kegg_mapper)
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper |> left_join(kodesc, by = "KEGG_ID")
kegg_mapper <- kegg_mapper %>% left_join(kodesc, by = "KEGG_ID")
View(kegg_mapper)
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
View(kegg_mapper)
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>% left_join(kodesc, by = "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(c(KEGG_ID = paste(KEGG_ID, collapse = ';'), KEGG_descr = paste(KEGG_descr, collapse = ';')))
kegg_mapper <- kegg_mapper %>%
reframe(.by = Transcript_ID)
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>% left_join(kodesc, by = "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
reframe(.by = Transcript_ID)
View(kegg_mapper)
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
str(kegg_mapper)
View(kegg_mapper)
annotations4 <- dplyr::left_join(annotations3, kegg_mapper)
View(annotations4)
annotations4 <- dplyr::left_join(annotations3, kegg_mapper) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Orthogroup,
Product,
Alias_Synonyms,
EC_number,
KEGG_ID,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
View(annotations4)
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
colnames(annotations) = c("Gene_ID",
"Transcript_ID",
"Feature",
"Contig",
"Start",
"Stop",
"Strand",
"Name",
"Product",
"Alias_Synonyms",
"EC_number",
"BUSCO",
"PFAM",
"InterPro",
"EggNog",
"COG",
"GO_Terms",
"Secreted",
"Membrane",
"Protease",
"CAZyme",
"antiSMASH",
"Notes",
"gDNA",
"mRNA",
"CDS_transcript",
"Translation")
View(annotations)
# read in the output from DeepLoc 2.0
deeploc <- read.csv(paste("DeepLoc2/",input_file,".deeploc2.csv", sep="")) %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::relocate(Gene_ID) %>%
dplyr::select(Gene_ID, Localizations, Signals)
colnames(deeploc) = c("Gene_ID", "Localizations_DeepLoc2", "Signals_DeepLoc2")
annotations2 <- dplyr::left_join(annotations, deeploc)
View(annotations2)
orthogroups <- read.delim(paste("../09_orthology/OrthoFinder/Results_Aug07/Custom_results/",input_file_short,".orthogroups.txt", sep=""), header = T, na.strings='') %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::select(Gene_ID, Orthogroup)
annotations3 <- dplyr::left_join(annotations2, orthogroups)
View(annotations3)
#kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", sep = "\t", header=FALSE)
#colnames(kodesc) <- c("KEGG_ID", "KEGG_descr")
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
annotations4 <- dplyr::left_join(annotations3, kegg_mapper) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Orthogroup,
Product,
Alias_Synonyms,
EC_number,
KEGG_ID,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
write.table(annotations4, paste("annotation_tables_merged/",input_file,".annotations.merged.txt", sep=""), sep='\t', quote = F, row.names = F)
input_file <- "porothrix_epigloea_S_TF4163_GCA_944036445"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
input_file <- "Sporothrix_epigloea_S_TF4163_GCA_944036445"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
setwd("~/Documents/2023_02_Sporothrix/10_annotations/")
annotations <- read.delim(paste("annotation_tables_funannotate/",input_file_short,".annotations.txt", sep=""), header = T, na.strings='')
colnames(annotations) = c("Gene_ID",
"Transcript_ID",
"Feature",
"Contig",
"Start",
"Stop",
"Strand",
"Name",
"Product",
"Alias_Synonyms",
"EC_number",
"BUSCO",
"PFAM",
"InterPro",
"EggNog",
"COG",
"GO_Terms",
"Secreted",
"Membrane",
"Protease",
"CAZyme",
"antiSMASH",
"Notes",
"gDNA",
"mRNA",
"CDS_transcript",
"Translation")
# read in the output from DeepLoc 2.0
deeploc <- read.csv(paste("DeepLoc2/",input_file,".deeploc2.csv", sep="")) %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::relocate(Gene_ID) %>%
dplyr::select(Gene_ID, Localizations, Signals)
colnames(deeploc) = c("Gene_ID", "Localizations_DeepLoc2", "Signals_DeepLoc2")
annotations2 <- dplyr::left_join(annotations, deeploc)
orthogroups <- read.delim(paste("../09_orthology/OrthoFinder/Results_Aug07/Custom_results/",input_file_short,".orthogroups.txt", sep=""), header = T, na.strings='') %>%
dplyr::mutate(Gene_ID = str_replace(Protein_ID, "(\\S*)(-T1)", "\\1")) %>%
dplyr::select(Gene_ID, Orthogroup)
annotations3 <- dplyr::left_join(annotations2, orthogroups)
#kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", sep = "\t", header=FALSE)
#colnames(kodesc) <- c("KEGG_ID", "KEGG_descr")
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
input_file <- "Sporothrix_epigloea_S_TF4163MAG_GCA_944036445"
input_file_short <- stringr::str_replace(input_file, "(\\S+)(_S)(_\\S+)(_GCA\\S+)", "\\1\\3")
#kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", sep = "\t", header=FALSE)
#colnames(kodesc) <- c("KEGG_ID", "KEGG_descr")
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
#kodesc <- data.table::fread("https://rest.kegg.jp/list/ko", sep = "\t", header=FALSE)
#colnames(kodesc) <- c("KEGG_ID", "KEGG_descr")
kegg_mapper <- read.delim(paste("kegg/kegg_output/",input_file,"/",input_file,".kegg.mapper.txt", sep=""), header = F, na.strings='')
colnames(kegg_mapper) <- c("Transcript_ID", "KEGG_ID")
kegg_mapper <- kegg_mapper %>%
group_by(Transcript_ID) %>%
summarize(KEGG_ID = paste(KEGG_ID, collapse = ';'))
annotations4 <- dplyr::left_join(annotations3, kegg_mapper) %>%
select(Gene_ID,
Transcript_ID,
Feature,
Contig,
Start,
Stop,
Strand,
Name,
Orthogroup,
Product,
Alias_Synonyms,
EC_number,
KEGG_ID,
BUSCO,
PFAM,
InterPro,
EggNog,
COG,
GO_Terms,
Secreted,
Membrane,
Localizations_DeepLoc2,
Signals_DeepLoc2,
Protease,
CAZyme,
antiSMASH,
Notes,
gDNA,
mRNA,
CDS_transcript,
Translation)
write.table(annotations4, paste("annotation_tables_merged/",input_file,".annotations.merged.txt", sep=""), sep='\t', quote = F, row.names = F)
View(annotations4)
