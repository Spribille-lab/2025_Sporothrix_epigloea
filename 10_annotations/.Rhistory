"Ophiostoma_ips_VPRI43529",
"Sporothrix_brunneoviolacea_CBS124561",
"Ophiostoma_fasciatum_VPRI43845",
"Sporothrix_insectorum_RCEF264",
"Leptographium_lundbergii_CBS138716")
row_labels
row_labels = genome
row_labels
names(row_labels) = c("S. euskadiensis VPRI43754",
"S. pseudoabietina VPRI43531",
"S. variecibatus CBS 121961",
"S. protearum CBS 116654",
"S. humicola CBS 118129",
"S. pallida CBS 131.56",
"S. mexicana CBS 120341",
"S. brasiliensis 5110",
"S. schenckii 1099",
"S. globosa CBS 120340",
"S. luriei CBS 937.72",
"S. phasma CBS 119721",
"S. dimorphospora CBS 553.74",
"S. inflata_CBS 239.68",
"S. bragantina CBS 474.91",
"S. curviconia CBS 959.73",
"S. thermara CBS 139747MAG",
"S. epigloea CBS 573.63",
"S. epigloea TF4163MAG",
"S. epigloea CBS 119000",
"S. eucalyptigena CBS 139899",
"S. eucalyptigena CBS 140593",
"S. nigrograna VPRI43755",
"O. novo-ulmi H327",
"O. ips VPRI43529",
"S. brunneoviolacea CBS 124561",
"O. fasciatum VPRI43845",
"S. insectorum RCEF264",
"L. lundbergii CBS 138716")
row_labels
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = row_labels[rownames(CAZyme_matrix)],
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
cazyme_hm
row_labels
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = row_labels,
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
cazyme_hm
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = row_labels[rownames],
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
names(row_labels)
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
cazyme_hm
col_fun = colorRamp2(c(0, max(unlist(secmets_matrix))), c("white", "deepskyblue4"))
secmets_hm <- Heatmap(secmets_matrix,
name = "BGCs",
col = col_fun,
column_title = "Biosynthetic gene\nclusters",
column_title_gp = gpar(fontsize = 12),
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(secmets_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
secmets_hm
col_fun = colorRamp2(c(0, max(unlist(merops_matrix))), c("white", "aquamarine4"))
merops_hm <- Heatmap(merops_matrix,
name = "proteases",
column_title = "Protease\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_names_gp = grid::gpar(fontsize = 8),
width = unit(4.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(merops_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
merops_hm
library(circlize)
col_fun = colorRamp2(c(0, 1), c("white", "grey"))
col_fun(seq(0, 3))
attributes_hm <- Heatmap(genome_attributes_lifestyle_matrix,
name = "Attributes",
column_title = "Association\n",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_heatmap_legend = FALSE,
show_column_dend = FALSE)
attributes_hm
attributes_hm + cazyme_hm + secmets_hm + merops_hm
library(circlize)
col_fun = colorRamp2(c(0, max(unlist(CAZyme_matrix))), c("white", "darkorchid"))
col_fun(seq(0, 3))
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
cazyme_hm
col_fun = colorRamp2(c(0, max(unlist(secmets_matrix))), c("white", "deepskyblue4"))
secmets_hm <- Heatmap(secmets_matrix,
name = "BGCs",
col = col_fun,
column_title = "Biosynthetic gene\nclusters",
column_title_gp = gpar(fontsize = 12),
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(secmets_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
secmets_hm
col_fun = colorRamp2(c(0, max(unlist(merops_matrix))), c("white", "aquamarine4"))
merops_hm <- Heatmap(merops_matrix,
name = "proteases",
column_title = "Protease\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(4.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(merops_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
merops_hm
library(circlize)
col_fun = colorRamp2(c(0, 1), c("white", "grey"))
col_fun(seq(0, 3))
attributes_hm <- Heatmap(genome_attributes_lifestyle_matrix,
name = "Attributes",
column_title = "Association\n",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_heatmap_legend = FALSE,
show_column_dend = FALSE)
attributes_hm
row_labels = genome
row_labels
names(row_labels) = c("S. euskadiensis VPRI43754",
"S. pseudoabietina VPRI43531",
"S. variecibatus CBS 121961",
"S. protearum CBS 116654",
"S. humicola CBS 118129",
"S. pallida CBS 131.56",
"S. mexicana CBS 120341",
"S. brasiliensis 5110",
"S. schenckii 1099",
"S. globosa CBS 120340",
"S. luriei CBS 937.72",
"S. phasma CBS 119721",
"S. dimorphospora CBS 553.74",
"S. inflata CBS 239.68",
"S. bragantina CBS 474.91",
"S. curviconia CBS 959.73",
"S. thermara CBS 139747MAG",
"S. epigloea CBS 573.63",
"S. epigloea TF4163MAG",
"S. epigloea CBS 119000",
"S. eucalyptigena CBS 139899",
"S. eucalyptigena CBS 140593",
"S. nigrograna VPRI43755",
"O. novo-ulmi H327",
"O. ips VPRI43529",
"S. brunneoviolacea CBS 124561",
"O. fasciatum VPRI43845",
"S. insectorum RCEF264",
"L. lundbergii CBS 138716")
names(row_labels)
library(circlize)
col_fun = colorRamp2(c(0, max(unlist(CAZyme_matrix))), c("white", "darkorchid"))
col_fun(seq(0, 3))
cazyme_hm <- Heatmap(CAZyme_matrix,
name = "CAZymes",
column_title = "CAZyme\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_column_dend = FALSE,
left_annotation = annotations,
#left_annotation = rowAnnotation(
#pathogen = genome_attributes_matrix[,"mammal_pathogen"],
#soil = genome_attributes_matrix[,"soil"],
#arthropod = genome_attributes_matrix[,"arthropod"],
#wood = genome_attributes_matrix[,"wood"],
#infructescence = genome_attributes_matrix[,"infructescence"],
#macrofungus = genome_attributes_matrix[,"macrofungus"],
#col = list(arthropod = c("1" = "black",
#"NA" = "azure"),
# pathogen = c("1" = "black",
#"NA" = "white"),
#soil = c("1" = "black",
#"NA" = "white"),
#wood = c("1" = "black",
#"NA" = "white"),
#infructescence = c("1" = "black",
#"NA" = "white"),
#macrofungus = c("1" = "black",
#"NA" = "white")),
#show_legend = FALSE),
show_heatmap_legend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(CAZyme_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
cazyme_hm
col_fun = colorRamp2(c(0, max(unlist(secmets_matrix))), c("white", "deepskyblue4"))
secmets_hm <- Heatmap(secmets_matrix,
name = "BGCs",
col = col_fun,
column_title = "Biosynthetic gene\nclusters",
column_title_gp = gpar(fontsize = 12),
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(secmets_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
secmets_hm
col_fun = colorRamp2(c(0, max(unlist(merops_matrix))), c("white", "aquamarine4"))
merops_hm <- Heatmap(merops_matrix,
name = "proteases",
column_title = "Protease\nclasses",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(4.5, "cm"),
height = unit(8, "cm"),
#right_annotation = annotations,
show_heatmap_legend = FALSE,
show_column_dend = FALSE,
cell_fun = function(j, i, x, y, width, height, fill) {
grid.text(merops_matrix[i, j], x, y, gp = gpar(fontsize = 6))})
merops_hm
library(circlize)
col_fun = colorRamp2(c(0, 1), c("white", "grey"))
col_fun(seq(0, 3))
attributes_hm <- Heatmap(genome_attributes_lifestyle_matrix,
name = "Attributes",
column_title = "Association\n",
column_title_gp = gpar(fontsize = 12),
col = col_fun,
cluster_rows = ML_dend,
row_dend_width = unit(2, "cm"),
column_names_gp = grid::gpar(fontsize = 8),
row_names_side = "left",
row_labels = names(row_labels),
row_names_gp = grid::gpar(fontsize = 8),
width = unit(3, "cm"),
height = unit(8, "cm"),
show_heatmap_legend = FALSE,
show_column_dend = FALSE)
attributes_hm
attributes_hm + cazyme_hm + secmets_hm + merops_hm
#write to pdf
pdf(file="figures/sporothrix_overview.pdf", width=12, height=8)
attributes_hm + cazyme_hm + secmets_hm + merops_hm
decorate_annotation("compl", {
grid.text("Assembly", y = unit(1, "npc") + unit(18, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("compl", {
grid.text("completeness", y = unit(1, "npc") + unit(13, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("bp", {
grid.text("Mbp", y = unit(1, "npc") + unit(7, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("proteins", {
grid.text("Predicted", y = unit(1, "npc") + unit(18, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("proteins", {
grid.text("proteins", y = unit(1, "npc") + unit(13, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("YR", {
grid.text("YRs", y = unit(1, "npc") + unit(13, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
decorate_annotation("repeats", {
grid.text("% repeats", y = unit(1, "npc") + unit(7, "mm"), just = "bottom", rot = 0, gp = gpar(fontsize = 12))
})
dev.off()
