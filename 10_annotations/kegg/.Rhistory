col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 2),
name="Module completeness", border=TRUE,
column_names_max_height =unit(5,"cm"))+
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway","degradation",
"biosynthesis"),
max_words = 40,fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=20, height=30)
draw(ht1)
dev.off()
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness", border=TRUE,
column_names_max_height =unit(5,"cm"))+
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway","degradation",
"biosynthesis"),
max_words = 40,fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness", border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway","degradation",
"biosynthesis"),
max_words = 40,fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness", border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway",
"degradation",
"biosynthesis"),
max_words = 40,fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness", border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway",
"degradation",
"biosynthesis"),
max_words = 40,fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness",
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "horizontal",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness",
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
heatmap_legend_side = "left",
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness",
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm"),
legend_side = "left"
),
#heatmap_legend_side = "left",
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness",
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1)
dev.off()
ht1 <- Heatmap(hdf,
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
name="Module completeness",
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
width = unit(9, "cm"),
height = unit(30, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 5),
row_title = NULL,
width = unit(9, "cm"),
height = unit(30, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 2),
row_title = NULL,
width = unit(9, "cm"),
height = unit(30, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
width = unit(9, "cm"),
height = unit(35, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
width = unit(9, "cm"),
height = unit(35, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway",
"degradation",
"biosynthesis"),
max_words = 40,
fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=15)
draw(ht1, heatmap_legend_side = "left")
dev.off()
pdf(file="module_completeness.pdf", width=10, height=18)
draw(ht1, heatmap_legend_side = "left")
dev.off()
View(genome_df)
genomes
View(hdf)
column_labels
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
#column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
width = unit(9, "cm"),
height = unit(35, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway",
"degradation",
"biosynthesis"),
max_words = 40,
fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=18)
draw(ht1, heatmap_legend_side = "left")
dev.off()
## Obtain K-means clustering
km = kmeans(hdf, centers = 20)$cluster
gene_list <- split(row.names(hdf), km)
gene_list <- lapply(gene_list, function(x) {
x[!is.na(x)]
})
annotList <- list()
for (i in names(gene_list)) {
maps <- (moddesc |> dplyr::filter(V1 %in% gene_list[[i]]))$V2
annotList[[i]] <-  maps
}
ht1 <- Heatmap(hdf,
name="Module\ncompleteness",
show_column_names = TRUE,
show_row_names = TRUE,
row_names_side = "left",
col=col_fun,
row_split=km,
cluster_columns = FALSE,
#column_order = order(genomes),
column_labels = column_labels[colnames(hdf)],
column_names_gp = grid::gpar(fontsize = 7),
row_names_gp = grid::gpar(fontsize = 6),
row_title = NULL,
width = unit(9, "cm"),
height = unit(35, "cm"),
heatmap_legend_param = list(
legend_direction = "vertical",
legend_width = unit(5, "cm")
),
rect_gp = gpar(col = "white", lwd = 0),
border=TRUE,
#column_names_max_height =unit(5,"cm")
) +
rowAnnotation(
keywords = simplifyEnrichment::anno_word_cloud(align_to = km,
term=annotList,
exclude_words=c("pathway",
"degradation",
"biosynthesis"),
max_words = 40,
fontsize_range = c(5,20))
)
pdf(file="module_completeness.pdf", width=10, height=18)
draw(ht1, heatmap_legend_side = "left")
dev.off()
if (!requireNamespace("BiocManager", quietly = TRUE))
BiocManager::install("InteractiveComplexHeatmap")
library("InteractiveComplexHeatmap")
htShiny()
